<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soumya Malviya | Strategic Portfolio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome (chess icons) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --board-size: 320px;
      --light: #f0e9d2;
      --dark: #8b735b;
      --frame: #5a4a3a;
      --square-shadow: rgba(0,0,0,0.25);
      --move-highlight: #eab308;
    }
    @media (min-width: 768px){ :root{ --board-size: 420px; } }

    body { font-family: 'Inter', sans-serif; background-color: #1a1a1a; color: #f0e9d2; }
    h1, h2, h3, h4, h5, h6 { font-family: 'Lora', serif; }

    .chess-bg{
      background-image:
        linear-gradient(rgba(26,26,26,0.94), rgba(26,26,26,0.94)),
        url('https://images.unsplash.com/photo-1580541832626-2a7131ee809f?q=80&w=2070&auto=format&fit=crop');
      background-size: cover; background-position: center;
    }

    .board-wrap{
      width: var(--board-size); height: var(--board-size); margin: 0 auto;
      border: 14px solid var(--frame); border-radius: 8px;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(0,0,0,0.08));
      position: relative;
    }
    .board{
      position: absolute; inset: 10px; display: grid;
      grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr);
      border-radius: 4px; overflow: hidden; box-shadow: inset 0 0 0 1px rgba(0,0,0,0.35);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
    }
    .square{
      position: relative; display: flex; align-items: center; justify-content: center;
      transition: background-color 0.25s ease; box-shadow: inset 0 0 6px var(--square-shadow);
    }
    .light{ background: radial-gradient(35% 35% at 30% 30%, rgba(255,255,255,0.15), transparent 60%), var(--light); }
    .dark{  background: radial-gradient(35% 35% at 30% 30%, rgba(255,255,255,0.08), transparent 60%), var(--dark); }

    .coord{ position: absolute; font-size: 10px; color: rgba(0,0,0,0.55); text-shadow: 0 1px 1px rgba(255,255,255,0.35); pointer-events: none; user-select: none; letter-spacing: 0.02em; }
    .file{ bottom: 4px; right: 6px; }
    .rank{ top: 4px; left: 6px; }

    .piece{
      font-size: calc(var(--board-size) / 12);
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.45));
      transition: transform 0.55s cubic-bezier(0.4,0,0.2,1);
      will-change: transform;
    }
    @media (min-width: 768px){ .piece{ font-size: calc(var(--board-size) / 11.2); } }
    .white{ color: #fff; }
    .black{ color: #2a2a2a; }

    .square.highlight{
      outline: 3px solid var(--move-highlight); outline-offset: -3px;
      box-shadow: inset 0 0 0 2px rgba(0,0,0,0.35), inset 0 0 18px rgba(234,179,8,0.35);
    }

    .scroll-reveal{ opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
    .scroll-reveal.visible{ opacity: 1; transform: translateY(0); }

    .skill-card{ transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .skill-card:hover{ transform: translateY(-8px); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
  </style>
</head>
<body class="antialiased">
  <!-- Header -->
  <header class="fixed top-0 left-0 right-0 z-50 transition-all duration-300" id="navbar">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
      <a href="#" class="text-2xl font-bold text-white">Soumya Malviya</a>
      <div class="hidden md:flex items-center space-x-8">
        <a href="#about" class="text-gray-300 hover:text-white transition">About</a>
        <a href="#projects" class="text-gray-300 hover:text-white transition">Projects</a>
        <a href="#skills" class="text-gray-300 hover:text-white transition">Skills</a>
        <a href="#contact" class="bg-[#8b735b] text-white px-4 py-2 rounded-md hover:bg-[#a08b74] transition shadow-lg">Contact</a>
      </div>
      <button id="mobile-menu-btn" class="md:hidden text-white text-2xl">
        <i class="fas fa-bars"></i>
      </button>
    </nav>
    <div id="mobile-menu" class="hidden md:hidden bg-[#1f1f1f] py-4">
      <a href="#about" class="block text-center text-gray-300 hover:text-white py-2">About</a>
      <a href="#projects" class="block text-center text-gray-300 hover:text-white py-2">Projects</a>
      <a href="#skills" class="block text-center text-gray-300 hover:text-white py-2">Skills</a>
      <a href="#contact" class="block text-center text-gray-300 hover:text-white py-2">Contact</a>
    </div>
  </header>

  <!-- Hero -->
  <section id="home" class="chess-bg min-h-screen flex items-center">
    <div class="container mx-auto px-6 text-center">
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div class="text-left">
          <h1 class="text-5xl md:text-7xl font-bold text-white leading-tight">Soumya Malviya</h1>
          <p class="text-xl md:text-2xl text-[#a08b74] font-semibold mt-2 mb-4">AI Engineer & Full-Stack Developer</p>
          <p id="hero-subtitle" class="text-lg md:text-xl text-gray-300 mt-4 max-w-lg">
            <!-- This text is dynamically injected by JavaScript -->
          </p>
          <a href="#projects" class="mt-8 inline-block bg-[#8b735b] text-white px-8 py-3 rounded-md text-lg hover:bg-[#a08b74] transition shadow-lg">View Projects</a>
        </div>

        <!-- Chessboard -->
        <div class="flex flex-col items-center">
          <div class="board-wrap">
            <div class="board" id="chessboard"><!-- squares injected --></div>
          </div>
          <p id="opening-name" class="text-gray-400 mt-4 text-sm italic">Featuring a classic opening</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Main -->
  <main class="bg-[#1f1f1f]">
    <!-- About -->
    <section id="about" class="py-20 scroll-reveal">
      <div class="container mx-auto px-6">
        <div class="text-center mb-16">
          <h2 class="text-4xl font-bold text-white">My Opening Strategy</h2>
          <p class="text-gray-400 mt-2">Developing a strong position from the first move.</p>
        </div>
        <div class="grid md:grid-cols-2 gap-16 items-center max-w-6xl mx-auto">
          <div class="text-center md:text-left">
            <img src="https://placehold.co/150x150/f0e9d2/1a1a1a?text=SM" alt="Soumya Malviya Portrait" class="w-40 h-40 rounded-full mx-auto md:mx-0 mb-6 border-4 border-[#8b735b]">
            <h3 class="text-3xl font-bold text-white mb-4">Thinking Several Moves Ahead</h3>
            <p class="text-gray-300 leading-relaxed">
              I'm Soumya Malviya, an engineer who builds systems that balance creative strategy with robust implementation. My passion lies in architecting solutions that are not just functional but also elegant and forward-thinking, much like a well-played chess game.
            </p>
          </div>
          <div class="space-y-8">
            <div class="flex items-start space-x-4">
              <div class="text-5xl text-[#8b735b]"><i class="fas fa-chess-king"></i></div>
              <div>
                <h4 class="text-2xl font-bold text-white">Strategic Vision</h4>
                <p class="text-gray-400">Roadmaps where each move compounds toward an inevitable endgame.</p>
              </div>
            </div>
            <div class="flex items-start space-x-4">
              <div class="text-5xl text-[#8b735b]"><i class="fas fa-chess-queen"></i></div>
              <div>
                <h4 class="text-2xl font-bold text-white">Creative Tactics</h4>
                <p class="text-gray-400">Inventive ideas grounded in solid positional understanding.</p>
              </div>
            </div>
            <div class="flex items-start space-x-4">
              <div class="text-5xl text-[#8b735b]"><i class="fas fa-chess-rook"></i></div>
              <div>
                <h4 class="text-2xl font-bold text-white">Robust Defense</h4>
                <p class="text-gray-400">Maintainability, reliability, and performance under pressure.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Projects -->
    <section id="projects" class="py-20 bg-[#1a1a1a] scroll-reveal">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-white">Featured Gambits</h2>
          <p class="text-gray-400 mt-2">A collection of strategic, results-focused builds.</p>
        </div>
        <div class="grid md:grid-cols-2 gap-8">
          <!-- Project Intern -->
          <div class="bg-[#2a2a2a] rounded-lg overflow-hidden shadow-xl transform hover:-translate-y-2 transition duration-300">
            <img src="https://placehold.co/600x400/8b735b/f0e9d2?text=Trading+Analysis" alt="Trading Analysis Project" class="w-full h-48 object-cover">
            <div class="p-6">
              <h3 class="text-xl font-bold text-white mb-2">Trading Analyst Intern</h3>
              <p class="text-sm text-gray-400 mb-2">Axxela Research & Analytics</p>
              <p class="text-xs text-gray-500 mb-2">[May ’25 – Jul ’25]</p>
              <p class="text-gray-400 mb-4 text-sm">
                Analyzed EUR interest rate markets, traded derivatives, and developed a SOFR fix forecasting pipeline using XGBoost and LSTM models, achieving 95% directional accuracy.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Python</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">XGBoost</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">LSTM</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">TensorFlow</span>
              </div>
              <a href="https://drive.google.com/file/d/1pMQ7d4oNkCO0A2Y0DLCGDG3uknjW4E01/view?usp=sharing" class="text-[#f0e9d2] hover:text-white font-semibold mr-4">Certificate →</a>
              <a href="https://drive.google.com/file/d/19FrxkjITuvLhzxzF-_fR_jN6pbvrHbOy/view?usp=sharing" class="text-[#f0e9d2] hover:text-white font-semibold">LOR →</a>
            </div>
          </div>
          <!-- Project 1 -->
          <div class="bg-[#2a2a2a] rounded-lg overflow-hidden shadow-xl transform hover:-translate-y-2 transition duration-300">
            <img src="https://placehold.co/600x400/8b735b/f0e9d2?text=FYEV+AI" alt="FYEV Project" class="w-full h-48 object-cover">
            <div class="p-6">
              <h3 class="text-xl font-bold text-white mb-2">FYEV: AI-Powered EV Recommender</h3>
              <p class="text-xs text-gray-500 mb-2">[Aug ’25 – Present]</p>
              <p class="text-gray-400 mb-4 text-sm">
                Developed an AI platform to simplify EV adoption with intelligent search and education modules. Built a full-stack solution using Flask, JS, and MongoDB, integrating the Gemini API and a station locator.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Flask</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">JavaScript</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">MongoDB</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Gemini API</span>
              </div>
              <a href="https://github.com/soumya-malviya-051/FYEV-EVT" class="text-[#f0e9d2] hover:text-white font-semibold">View Project →</a>
            </div>
          </div>
          <!-- Project 2 -->
          <div class="bg-[#2a2a2a] rounded-lg overflow-hidden shadow-xl transform hover:-translate-y-2 transition duration-300">
            <img src="https://placehold.co/600x400/8b735b/f0e9d2?text=Gravity+Lensing" alt="Gravitational Lensing Project" class="w-full h-48 object-cover">
            <div class="p-6">
              <h3 class="text-xl font-bold text-white mb-2">Gravitational Lensing Image Generation</h3>
              <p class="text-xs text-gray-500 mb-2">[April ’25 - May ’25]</p>
              <p class="text-gray-400 mb-4 text-sm">
                Developed a PyTorch-based DDPM to generate realistic gravitational lensing images. Explored UNet architectures and noise schedules to improve image quality, evaluating results with FID scores.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">PyTorch</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Diffusion Models</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">UNet</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Computer Vision</span>
              </div>
              <a href="https://github.com/soumya-malviya-051/Lensing-Diffusion" class="text-[#f0e9d2] hover:text-white font-semibold">View Project →</a>
            </div>
          </div>
          <!-- Project 3 -->
          <div class="bg-[#2a2a2a] rounded-lg overflow-hidden shadow-xl transform hover:-translate-y-2 transition duration-300">
            <img src="https://placehold.co/600x400/8b735b/f0e9d2?text=DISS" alt="Document Intelligence Search System" class="w-full h-48 object-cover">
            <div class="p-6">
              <h3 class="text-xl font-bold text-white mb-2">Document Intelligence Search System</h3>
              <p class="text-xs text-gray-500 mb-2">[March ’25 – April ’25]</p>
              <p class="text-gray-400 mb-4 text-sm">
                Built a system to process PDFs, create vector embeddings, and enable conversational querying with hybrid search. Developed a Python/FAISS backend with an Ollama LLM and a responsive React frontend.
              </p>
              <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">React</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">Python</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">FAISS</span>
                <span class="bg-[#4a3f35] text-xs font-semibold px-2 py-1 rounded">LLM</span>
              </div>
              <a href="https://github.com/soumya-malviya-051/DS-project" class="text-[#f0e9d2] hover:text-white font-semibold">View Project →</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Skills -->
    <section id="skills" class="py-20 bg-[#1f1f1f] scroll-reveal">
      <div class="container mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold text-white">My Arsenal</h2>
          <p class="text-gray-400 mt-2">The pieces commanded to secure results.</p>
        </div>
        <div class="max-w-6xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8 text-center">
          <div class="bg-[#2a2a2a] p-6 rounded-lg shadow-lg skill-card">
            <div class="text-6xl text-[#f0e9d2] mb-3"><i class="fas fa-chess-queen"></i></div>
            <h4 class="text-xl font-bold text-white">C++</h4>
            <p class="text-gray-400 text-sm">Versatile & Powerful</p>
          </div>
          <div class="bg-[#2a2a2a] p-6 rounded-lg shadow-lg skill-card">
            <div class="text-6xl text-[#f0e9d2] mb-3"><i class="fas fa-chess-rook"></i></div>
            <h4 class="text-xl font-bold text-white">Python</h4>
            <p class="text-gray-400 text-sm">Solid Foundations</p>
          </div>
          <div class="bg-[#2a2a2a] p-6 rounded-lg shadow-lg skill-card">
            <div class="text-6xl text-[#f0e9d2] mb-3"><i class="fas fa-chess-bishop"></i></div>
            <h4 class="text-xl font-bold text-white">Machine Learning</h4>
            <p class="text-gray-400 text-sm">Creative Maneuvers</p>
          </div>
          <div class="bg-[#2a2a2a] p-6 rounded-lg shadow-lg skill-card">
            <div class="text-6xl text-[#f0e9d2] mb-3"><i class="fas fa-chess-pawn"></i></div>
            <h4 class="text-xl font-bold text-white">Web Dev</h4>
            <p class="text-gray-400 text-sm">Core Structure</p>
          </div>
          <div class="bg-[#2a2a2a] p-6 rounded-lg shadow-lg skill-card">
            <div class="text-6xl text-[#f0e9d2] mb-3"><i class="fas fa-chess-knight"></i></div>
            <h4 class="text-xl font-bold text-white">Competitive<br>Programming</h4>
            <p class="text-gray-400 text-sm">Tactical Precision</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="py-20 bg-[#1a1a1a] scroll-reveal">
        <div class="container mx-auto px-6">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold text-white">Make Your Move</h2>
                <p class="text-gray-400 mt-2">Let’s connect and create something brilliant.</p>
            </div>
            <div class="flex justify-center items-center space-x-10 md:space-x-16">
                <a href="mailto:soumyamalviya051@gmail.com" target="_blank" class="text-gray-400 hover:text-white transform hover:scale-110 transition duration-300">
                    <i class="fas fa-envelope text-5xl"></i>
                </a>
                <a href="https://github.com/soumya-malviya-051" target="_blank" class="text-gray-400 hover:text-white transform hover:scale-110 transition duration-300">
                    <i class="fab fa-github text-5xl"></i>
                </a>
                <a href="https://www.linkedin.com/in/soumya-malviya-40a76b319?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank" class="text-gray-400 hover:text-white transform hover:scale-110 transition duration-300">
                    <i class="fab fa-linkedin text-5xl"></i>
                </a>
            </div>
        </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-[#1a1a1a] py-6">
    <div class="container mx-auto px-6 text-center text-gray-500">
      <p>&copy; 2025 Soumya Malviya. All Rights Reserved.</p>
    </div>
  </footer>

  <!-- chess.js (PGN parsing) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navbar scroll effect
      const navbar = document.getElementById('navbar');
      window.addEventListener('scroll', () => {
        navbar.classList.toggle('bg-[#1a1a1a]', window.scrollY > 50);
        navbar.classList.toggle('shadow-lg', window.scrollY > 50);
      });

      // Mobile menu
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      mobileMenuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
      document.querySelectorAll('#mobile-menu a, nav a[href^="#"]').forEach(a => {
        a.addEventListener('click', function (e) {
          e.preventDefault();
          if (mobileMenu.contains(e.target)) {
              mobileMenu.classList.add('hidden');
          }
          document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
        });
      });


      // Scroll reveal
      const scrollElements = document.querySelectorAll('.scroll-reveal');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
      }, { threshold: 0.1 });
      scrollElements.forEach(el => observer.observe(el));

      // =========================
      // Chessboard (Font Awesome)
      // =========================
      const iconMap = {
        'r': 'fa-chess-rook', 'n': 'fa-chess-knight', 'b': 'fa-chess-bishop',
        'q': 'fa-chess-queen', 'k': 'fa-chess-king', 'p': 'fa-chess-pawn',
        'R': 'fa-chess-rook', 'N': 'fa-chess-knight', 'B': 'fa-chess-bishop',
        'Q': 'fa-chess-queen', 'K': 'fa-chess-king', 'P': 'fa-chess-pawn'
      };
      const files = ['a','b','c','d','e','f','g','h'];
      const ranks = ['8','7','6','5','4','3','2','1'];
      const boardEl = document.getElementById('chessboard');

      function emptyRow(){ return [' ',' ',' ',' ',' ',' ',' ',' ']; }
      function startPosition(){
        return [
          ['r','n','b','q','k','b','n','r'],
          ['p','p','p','p','p','p','p','p'],
          emptyRow(), emptyRow(), emptyRow(), emptyRow(),
          ['P','P','P','P','P','P','P','P'],
          ['R','N','B','Q','K','B','N','R']
        ];
      }
      let position = startPosition();

      function createBoard(){
        boardEl.innerHTML = '';
        for(let r=0; r<8; r++){
          for(let c=0; c<8; c++){
            const sq = document.createElement('div');
            sq.className = 'square ' + (((r+c)%2===0)?'light':'dark');
            sq.dataset.row = r; sq.dataset.col = c;

            if (r === 7){ const f = document.createElement('span'); f.className='coord file'; f.textContent=files[c]; sq.appendChild(f); }
            if (c === 0){ const k = document.createElement('span'); k.className='coord rank'; k.textContent=ranks[r]; sq.appendChild(k); }

            const p = position[r][c];
            if (p !== ' '){
              const i = document.createElement('i');
              i.classList.add('fas', iconMap[p], 'piece', (p===p.toUpperCase() ? 'white' : 'black'));
              sq.appendChild(i);
            }
            boardEl.appendChild(sq);
          }
        }
      }

      function squareToRC(s){
        const file = s[0], rank = s[1];
        const c = files.indexOf(file);
        const r = 8 - parseInt(rank, 10);
        return [r, c];
      }

      function querySq([r,c]){ return boardEl.querySelector(`.square[data-row="${r}"][data-col="${c}"]`); }

      function highlight(from, to){
        const a = querySq(from), b = querySq(to);
        if (a) a.classList.add('highlight');
        if (b) b.classList.add('highlight');
        setTimeout(()=>{
          if (a) a.classList.remove('highlight');
          if (b) b.classList.remove('highlight');
        }, 1200);
      }

      function moveRookForCastle(color, side){
        // side: 'k' (short) or 'q' (long)
        if (color==='w' && side==='k'){ // h1 -> f1
          domInstantMove([7,7],[7,5]); position[7][5] = 'R'; position[7][7] = ' ';
        } else if (color==='w' && side==='q'){ // a1 -> d1
          domInstantMove([7,0],[7,3]); position[7][3] = 'R'; position[7][0] = ' ';
        } else if (color==='b' && side==='k'){ // h8 -> f8
          domInstantMove([0,7],[0,5]); position[0][5] = 'r'; position[0][7] = ' ';
        } else if (color==='b' && side==='q'){ // a8 -> d8
          domInstantMove([0,0],[0,3]); position[0][3] = 'r'; position[0][0] = ' ';
        }
      }

      function domInstantMove(fromRC, toRC){
        const fromSq = querySq(fromRC), toSq = querySq(toRC);
        if (!fromSq || !toSq) return;
        const icon = fromSq.querySelector('.piece');
        if (!icon) return;
        if (toSq.querySelector('.piece')) toSq.querySelector('.piece').remove();
        toSq.appendChild(icon);
      }

      function animateMoveVerbose(move){
        const fromRC = squareToRC(move.from);
        const toRC   = squareToRC(move.to);
        const fromSq = querySq(fromRC), toSq = querySq(toRC);
        if (!fromSq || !toSq) return;

        const pieceIcon = fromSq.querySelector('.piece');
        if (!pieceIcon) return;

        const mover = position[fromRC[0]][fromRC[1]];
        const fRect = pieceIcon.getBoundingClientRect();
        const tRect = toSq.getBoundingClientRect();
        const dx = (tRect.left + tRect.width/2) - (fRect.left + fRect.width/2);
        const dy = (tRect.top  + tRect.height/2) - (fRect.top  + fRect.height/2);

        pieceIcon.style.zIndex = '100';
        pieceIcon.style.transform = `translate(${dx}px, ${dy}px)`;
        highlight(fromRC, toRC);

        setTimeout(()=>{
          pieceIcon.style.zIndex = '';
          pieceIcon.style.transform = '';

          // Handle en passant capture
          if (move.flags && move.flags.indexOf('e') !== -1){
            const dir = (move.color === 'w') ? 1 : -1;
            const capSq = querySq([toRC[0] + dir, toRC[1]]);
            if (capSq && capSq.querySelector('.piece')) capSq.querySelector('.piece').remove();
            position[toRC[0] + dir][toRC[1]] = ' ';
          }
          
          // Handle normal capture
          if (toSq.querySelector('.piece')) {
            toSq.querySelector('.piece').remove();
          }

          // Move icon in DOM
          toSq.appendChild(pieceIcon);

          // Promotion handling
          if (move.promotion){
            const promo = move.promotion.toLowerCase();
            const promoted = (move.color === 'w') ? promo.toUpperCase() : promo;
            position[toRC[0]][toRC[1]] = promoted;
            pieceIcon.className = `fas ${iconMap[promoted]} piece ${move.color === 'w' ? 'white' : 'black'}`;
          } else {
            position[toRC[0]][toRC[1]] = mover;
          }
          position[fromRC[0]][fromRC[1]] = ' ';

          // Handle castling rook move
          if (move.flags && (move.flags.includes('k') || move.flags.includes('q'))){
             moveRookForCastle(move.color, move.flags.includes('k') ? 'k' : 'q');
          }
        }, 550);
      }

      const openings = [
        { name: "Ruy López, Berlin", pgn: "1. e4 e5 2. Nf3 Nc6 3. Bb5 Nf6 4. O-O Nxe4 5. d4 Nd6 6. Bxc6 dxc6 7. dxe5 Nf5 8. Qxd8+ Kxd8" },
        { name: "Italian Game, Giuoco Piano", pgn: "1. e4 e5 2. Nf3 Nc6 3. Bc4 Bc5 4. c3 Nf6 5. d3 d6 6. O-O O-O 7. Re1 a6 8. Bb3 Ba7" },
        { name: "Queen's Gambit Declined, Orthodox", pgn: "1. d4 d5 2. c4 e6 3. Nc3 Nf6 4. Bg5 Be7 5. e3 O-O 6. Nf3 h6 7. Bh4 b6 8. Rc1 Bb7 9. cxd5 exd5" },
        { name: "Sicilian Defense, Najdorf", pgn: "1. e4 c5 2. Nf3 d6 3. d4 cxd4 4. Nxd4 Nf6 5. Nc3 a6 6. Be3 e6 7. f3 Be7 8. Qd2 O-O" },
        { name: "King's Indian Defense, Classical", pgn: "1. d4 Nf6 2. c4 g6 3. Nc3 Bg7 4. e4 d6 5. Nf3 O-O 6. Be2 e5 7. O-O Nc6 8. d5 Ne7" },
        { name: "French Defense, Classical", pgn: "1. e4 e6 2. d4 d5 3. Nc3 Nf6 4. Bg5 Be7 5. e5 Nfd7 6. Bxe7 Qxe7 7. f4 a6 8. Nf3 c5" },
        { name: "Caro-Kann, Classical", pgn: "1. e4 c6 2. d4 d5 3. Nc3 dxe4 4. Nxe4 Bf5 5. Ng3 Bg6 6. h4 h6 7. Nf3 Nd7 8. h5 Bh7" },
        { name: "Scotch Game Mainline", pgn: "1. e4 e5 2. Nf3 Nc6 3. d4 exd4 4. Nxd4 Bc5 5. Be3 Qf6 6. c3 Nge7 7. Be2" },
        { name: "Vienna Game", pgn: "1. e4 e5 2. Nc3 Nf6 3. f4 d5 4. fxe5 Nxe4 5. Nf3 Be7 6. d4 O-O" },
        { name: "English Opening, Symmetrical", pgn: "1. c4 c5 2. Nc3 Nc6 3. g3 g6 4. Bg2 Bg7 5. e3 e6 6. Nge2 Nge7 7. O-O" },
        { name: "Slav Defense", pgn: "1. d4 d5 2. c4 c6 3. Nf3 Nf6 4. Nc3 e6 5. e3 Nbd7 6. Qc2 Bd6 7. Bd3" },
        { name: "Grünfeld Defense", pgn: "1. d4 Nf6 2. c4 g6 3. Nc3 d5 4. cxd5 Nxd5 5. e4 Nxc3 6. bxc3 Bg7 7. Nf3 c5 8. Be3" },
        { name: "Catalan Opening", pgn: "1. d4 Nf6 2. c4 e6 3. g3 d5 4. Bg2 Be7 5. Nf3 O-O 6. O-O dxc4 7. Qc2 a6 8. a4" },
        { name: "London System", pgn: "1. d4 d5 2. Nf3 Nf6 3. Bf4 e6 4. e3 c5 5. c3 Nc6 6. Nbd2 Bd6 7. Bg3" }
      ];
      
      const openingDescriptors = {
        "Ruy López": "Like the Ruy López, my approach is classical and strategic, building pressure methodically to create long-term advantages.",
        "Italian Game": "Reflecting the Italian Game, I focus on rapid, intuitive development and solid positioning to open up creative possibilities.",
        "Queen's Gambit": "My strategy mirrors the Queen's Gambit: making calculated sacrifices to gain central control and initiative.",
        "Sicilian Defense": "Embracing the complexity of the Sicilian Defense, I thrive on creating sharp, imbalanced positions to find decisive, tactical solutions.",
        "King's Indian": "Much like the King's Indian, I prefer a hypermodern approach, controlling the center from a distance before launching a decisive attack.",
        "French Defense": "My work is like the French Defense—solid, resilient, and structured, creating a tough-to-crack foundation that springs into powerful counter-attacks.",
        "Caro-Kann": "Echoing the Caro-Kann, I build exceptionally solid structures that are difficult to break down, neutralizing threats before launching my own strategic plans.",
        "Scotch Game": "Like the Scotch Game, I believe in opening up the position early, forcing a clear and tactical battle where precise calculation leads to victory.",
        "Vienna Game": "Channeling the Vienna Game, I employ aggressive and sometimes unconventional ideas to seize the initiative from the very first move.",
        "English Opening": "My style reflects the English Opening—flexible and positional, aiming to outmaneuver opponents by controlling key squares and concepts.",
        "Slav Defense": "Similar to the Slav Defense, I build an incredibly solid and reliable setup, preparing to unleash tactical potential when the time is right.",
        "Grünfeld": "In the spirit of the Grünfeld, I challenge the center from the start, creating dynamic, tactical play where a deep understanding of structure is key.",
        "London System": "Like the London System, I employ a universal, reliable system that is solid yet contains hidden attacking potential, adaptable to any challenge.",
        "default": "Every project is a calculated move toward smarter technology, combining tactical execution with long-term strategic vision."
      };

      function getOpeningDescription(name) {
        for (const key in openingDescriptors) {
            if (name.includes(key)) {
                return openingDescriptors[key];
            }
        }
        return openingDescriptors["default"];
      }

      // Random opening on each refresh
      const chosen = openings[Math.floor(Math.random() * openings.length)];
      document.getElementById('opening-name').textContent = `Featuring the ${chosen.name}`;
      document.getElementById('hero-subtitle').textContent = getOpeningDescription(chosen.name);

      // Build board
      createBoard();

      // Parse PGN and animate
      const game = new Chess();
      game.load_pgn(chosen.pgn);
      const verboseMoves = game.history({ verbose: true });

      // reset internal board to initial
      position = startPosition();
      createBoard();

      let idx = 0;
      function step(){
        if (idx < verboseMoves.length){
          animateMoveVerbose(verboseMoves[idx]);
          idx++;
          setTimeout(step, 1200);
        } else {
          setTimeout(()=>{
            idx = 0;
            position = startPosition();
            createBoard();
            setTimeout(step, 1500);
          }, 2500);
        }
      }
      setTimeout(step, 1600);
    });
  </script>
</body>
</html>
